<!DOCTYPE HTML>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="Content-Script-Type" content="text/javascript">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
    <!-- <link rel="stylesheet" href="css/style.css"> -->
 <script>
      var d = new Date();
      var day = d.getDay();
      if (day == 0){
        day = "sunday";
      }else if (day == 6) {
        day = "saturday";
      }else {
        day = "weekday";
      }

      var hour = d.getHours();
      var minute = d.getMinutes();
  　   if(minute > 30){
        var nextHour = hour + 1;
      }

      $(function(){
        $("#date").text("現在時刻: " + hour + "時" + minute + "分");
      });

      $(function() {
        $.getJSON("./tables.json" , function(data) {
          var len = data.length;

          function timeTable(start, destination){
            for(var i = 0; i < len; i++) {
              if(data[i].date == day && data[i].start == start && data[i].destination == destination){
                $('#' + start).append("<li>" + "(" + data[i].No + "号系統)" + hour + "時..." + data[i]["table"][hour] + "</li>");
              }
            }
            if(nextHour){
              $('#' + start).after('<ul id="' + start + '-next"></ul>');
              for(var i = 0; i < len; i++) {
                if(data[i].date == day && data[i].start == start && data[i].destination == destination){
                  $('#' + start + "-next").append("<li>" + "(" + data[i].No + "号系統)" + nextHour + "時..." + data[i]["table"][nextHour] + "</li>");
                }
              }
            }
          }

          timeTable('Dekijima-ohashi', 'Osaka-station');
          timeTable('Dekijima-ekimae', 'Osaka-station');
        });
      });
  </script>
</head>
<body>
  <div id="date"></div>
  <h2>出来島大橋から大阪駅</h2>
  <ul id="Dekijima-ohashi"></ul>
  <h2>出来島駅から大阪駅</h2>
  <ul id="Dekijima-ekimae"></ul>
  <h2>御幣島駅から大阪駅</h2>
  <ul id="Mitejima"></ul>
</body>
</html>
